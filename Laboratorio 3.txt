# PRACTICA 1 – Configuración del GRUB y recuperación de contraseña Root

# Configurar el tiempo de espera del menú GRUB
# Edita el archivo de configuración de GRUB:
sudo nano /etc/default/grub

# Busca la línea:
GRUB_TIMEOUT=5
#y cámbiala a:
GRUB_TIMEOUT=20
# Guarda los cambios (Ctrl+O, Enter, Ctrl+X)
# Aplica la configuración:
sudo grub2-mkconfig -o /boot/grub2/grub.cfg
# Verifica:
grep GRUB_TIMEOUT /etc/default/grub

# Método de recuperación si olvidas la contraseña del usuario root

# En el menú GRUB, selecciona tu sistema y presiona e para editar.
# Busca la línea que comienza con linux y agrega al final:
rd.break
#Presiona Ctrl + X o F10 para iniciar.

# Monta el sistema en modo lectura/escritura:
mount -o remount,rw /sysroot

# Entra en el entorno root:
chroot /sysroot

#Cambia la contraseña:
passwd root

# Actualiza el contexto de SELinux:
touch /.autorelabel

# Sal y reinicia:
exit
reboot

# Al iniciar de nuevo, podrás acceder con la nueva contraseña root.


# PRACTICA 2 – Scripting y automatización

# Script para crear backup comprimido con TAR
#Crea el script:
nano backup_home.sh
# Pon esto adentro para automatizar el backup
#!/bin/bash
# Script de backup de la carpeta /home/usuario

FECHA=$(date +"%d-%m-%Y_%H-%M")
USUARIO=$(whoami)
DESTINO="/home/$USUARIO/backup_$FECHA.tar.gz"

tar -czvf "$DESTINO" "/home/$USUARIO"

echo "Backup completado: $DESTINO"

# Dale permisos de ejecución:
chmod +x backup_home.sh
# Ejecuta el script:
./backup_home.sh
# Resultado esperado:
backup_09-10-2025_17-30.tar.gz

# Script que copia el resultado de ifconfig al escritorio
# Crea el script:
nano guardar_ifconfig.sh
# Contenido:
#!/bin/bash
# Script para guardar la salida de ifconfig en el escritorio

read -p "Ingrese el nombre del archivo: " nombre
ifconfig > ~/Escritorio/${nombre}.txt

echo "Archivo creado en el Escritorio con el nombre: ${nombre}.txt"

# Dale Permisos y ejecución:
chmod +x guardar_ifconfig.sh
./guardar_ifconfig.sh
# Resultado esperado:
red_info.txt


# PRACTICA 3 – Acceso remoto SSH y autenticación con llaves

# Configurar modo Bridge y probar conectividad

# Apaga la VM → abre la configuración → Adaptador de red → Modo Bridge
# Enciende la VM y obtén su IP:
ip a
# Desde Windows, abre CMD y prueba:
ping <IP_de_la_VM>

# Habilitar servicio SSH
sudo dnf install openssh-server -y
sudo systemctl enable --now sshd
sudo systemctl status sshd

# Prueba desde Windows con PowerShell o CMD:
ssh tu_usuario@<IP_de_la_VM>
# Introduce tu contraseña para comprobar el acceso.

# Generar llaves SSH en Windows
# Desde PowerShell o CMD:
ssh-keygen
# Cuando te pida directorio, presiona Enter
# Se generarán dos archivos:
#id_rsa (privada)
#id_rsa.pub (pública)

# Copiar la llave pública al servidor Linux

# Desde PowerShell:
scp C:\Users\<usuario>\.ssh\id_rsa.pub tu_usuario@<IP_de_la_VM>:/home/tu_usuario/
# Luego, en Linux:
mkdir -p ~/.ssh
cat ~/id_rsa.pub >> ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

# Probar conexión automática sin contraseña

# Desde Windows:
ssh tu_usuario@<IP_de_la_VM>
# Si todo fue correcto, entrarás directamente sin pedir contraseña.